<!DOCTYPE html>

<html lang="en">

<head>

    <title>Friend Survey</title>

    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</head>

<body>
    <div class="container" id="survey">

        <h1>All the Questions</h1>

        <hr>

        <form>

            <h2>Personal Information</h2>

            <div class="form-group">

                <label for="name">Give us your data! We promise not to use it for evil.</label>
                <input type="text" class="form-control" id="name" placeholder="Your Name">

            </div>

            <div class="form-group">

                <div class="custom-file">

                    <input type="text" class="form-control" id="photo" placeholder="Link to Photo">

                </div>
            </div>

        </form>

        <hr>

        <h3>Question 1</h3>

            <p>My favorite color is black.</p>

            <select class="form-control form-control-sm w-25" id="q1">

                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree</option>
                <option value ="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>

        <h3>Question 2</h3>

            <p>I play World of Warcraft.</p>

            <select class="form-control form-control-sm w-25" id="q2">

                <option selected>Select an Option</option>
                <option value="1">1 (Strongly Disagree</option>
                <option value ="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
                
            </select>
        <br>

        <h3>Question 3</h3>

        <p>I'd rather be on a computer than at a party.</p>

        <select class="form-control form-control-sm w-25" id="q3">

            <option selected>Select an Option</option>
            <option value="1">1 (Strongly Disagree</option>
            <option value ="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>

            
        </select>

        <br>

        <h3>Question 4</h3>

            <p>I am a cat person.</p>

            <select class="form-control form-control-sm w-25" id="q4">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>

        <h3>Question 5</h3>

            <p>I am a dog person.</p>

            <select class="form-control form-control-sm w-25" id="q5">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>

        <h3>Question 6</h3>

            <p>I love all animals.</p>

            <select class="form-control form-control-sm w-25" id="q6">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>

        <h3>Question 7</h3>

            <p>Winter is my favorite season.</p>

            <select class="form-control form-control-sm w-25" id="q7">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
         <br>

         <h3>Question 8</h3>

            <p>I enjoy hiking and various outdoorsy activities.</p>

            <select class="form-control form-control-sm w-25" id="q8">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>

        <h3>Question 9</h3>

            <p>I am an introvert.</p>

            <select class="form-control form-control-sm w-25" id="q9">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>

        <h3>Question 10</h3>

            <p>I prefer beer to wine and liquor.</p>

            <select class="form-control form-control-sm w-25" id="q10">

                    <option selected>Select an Option</option>
                    <option value="1">1 (Strongly Disagree</option>
                    <option value ="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>

                
            </select>
        <br>


    


    <hr>

        <button type="submit" class="btn btn-primary" data-toggle="modal" data-target="#showFriend" id="submit">Find me some friends!</button>

    <div class = "modal fade" id="showFriend" tabindex="-1" role="dialog" arialavelledby="modalTitle" aria-hidden="true">

        <div class="modal-dialog modal-dialog-centered" role="document">

            <div class="modal-content">

                <div class="modal-header">

                <h5 class="modal-title" id="exampleModalCenterTitle">Your friend match!</h5>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">

                    <span aria-hidden="true">&times;</span>

                </button>

                </div>

                <div class="modal-body">

                    <div id="user-photo">
                        
                    </div>

                    <div id="match-photo">

                    </div>
                
                </div>

                <div class="modal-footer">

                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                <a class="btn btn-primary" href="/api/friends" role="button" data-dismiss="modal">View Friends</button>

                </div>

            </div>

        </div>

    </div>

    </div>

    <div class="footer">
        <div class="container">
            <p>
                <a href="/api/friends">API Friends List</a>
                |
                <a href="https://github.com/tbender0211/FriendFinder">GitHub Repo</a>
            </p>
        </div>
    </div>

<script type="text/javascript">

    $("#submit").on("click", function(event){

        event.preventDefault();

        userImage = $("#photo").val();

        var newUser = {
            name: $("#name").val(),
            pic: userImage,
            answers: [parseInt($("#q1").val()), parseInt($("#q2").val()), parseInt($("#q3").val()), parseInt($("#q4").val()), parseInt($("#q5").val()), 
            parseInt($("#q6").val()), parseInt($("#q7").val()), parseInt($("#q8").val()), parseInt($("#q9").val()), parseInt($("#q10").val())],
            total: (parseInt($("#q1").val()) + parseInt($("#q2").val()) + parseInt($("#q3").val()) + parseInt($("#q4").val()) + parseInt($("#q5").val()) + 
            parseInt($("#q6").val()) + parseInt($("#q7").val()) + parseInt($("#q8").val()) + parseInt($("#q9").val()) + parseInt($("#q10").val())),
            difference: 0
        };

        $("#user-photo").html("<img src=" + userImage  + " alt=User Image>");

        console.log(newUser);

        $.get("api/friends", function(data){
            
            var differences = [];

            for(i=0; i < data.length; i++){

                
                var difference = 0;

                difference += Math.abs(newUser.total - data[i].total);
                data[i].difference = difference;
                differences.push(difference);

                console.log(differences);

                var match = Math.min.apply(Math, differences);
                console.log(match);

                if (data[i].difference === match){

                    console.log(data[i]);

                    $("#match-photo").html("<img src=" + data[i].pic + "alt=Match Image>");

                }

            }

        });        
        
        $.post("/api/friends", newUser, function(data){
            if (data) {
                console.log("New Friend added.");
            } else {
                console.log("Sorry, no matches.")
            }
        });


    });
</script>



</body>

</html>

<style>
    body {

        font-family: "Roboto Condensed", sans-serif;

    }

    #survey {

        border: 2px solid black;
        padding: 20px;
        margin-bottom: 20px;
        
    }
</style>